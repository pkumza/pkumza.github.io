<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Drupal Theme 主题系统 · Zablog</title><meta name="description" content="Drupal Theme 主题系统 - Zachary Marv"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://zablog.me/atom.xml" title="Zablog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/Aggerfrank" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pkumza" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Drupal Theme 主题系统</h1><div class="post-info">2014年6月22日</div><div class="post-content"><p>Drupal的外观控制是最为灵活可定制的，但是这个系统复杂而且不够直观。另外，某些思维不够流畅的作者经常会写出一些晦涩难懂的<em>Drupal主题高级特性</em>之类的文章，把学习Theme的激情完全打垮了。为此本文会从一个相对简单的视角，对Theme系统的原理、分布和一些使用做出介绍。</p>
<p>#工作原理<br>Drupal终归还是一个基于PHP的CMS，所有的最终技术还是通过HTML、CSS、PHP这些来完成，而那些布局和效果主要还是通过HTML和CSS和协作来完成。如果对于HTML和CSS不够了解，那还是先学习这些方面为好。尤其是现在HTML5和CSS3已经很成熟，能够方便、高效率地显示出优秀的效果。<br>另外，Drupal是一个CMS，而CMS的重要特征就是MVC式的开发，让显示和数据、控制分开。Drupal在这方面做的很好，甚至把View部分更加细化，数据的具体显示和布局，整体的显示和布局甚至都进行分开，使得Theme更专心于整体的显示效果。<br>Drupal采用了PHPTemplate这个主题引擎，来把这些显示技术结合起来。这个引擎在Drupal的核心中工作，操作Drupal的时候，改核心Core是大忌，一般不应该被修改，否则不仅会使得系统不稳定，而且破坏了开发的模块性，使开发陷入一团糟。我们需要做的就是使用模块化的方式，单独使用一些显示技术来实现对Drupal主题的定制。</p>
<p>#实现概览<br>Drupal中，有很多默认的主题。<br>在Drupal6的阶段，默认的主题一般是Garland主题，这是一个蓝色的，常见的主题。在Drupal7中，默认主题变为了Bartik，我觉得这个主题确实是比Garland要更好看一些。另外，系统默认还会安装一些其他的主题，比如seven、stark等等。<br>主题的定制可以简单，可以复杂。下面先说一下最简单的小定制。</p>
<p>##最简单的小定制<br>这里以定制默认主题Bartik为例。运行环境为Drupal7原版。<br>登陆管理页面，管理-》外观-》Bartik设置<br><img src="http://i11.tietuku.com/b1208924f93f9473.png" alt="Theme 1"><br>这时就进入了主题设置页面。<br><img src="http://i11.tietuku.com/996b1791487fd4e1.png" alt="Theme 2"><br>在这里，可以给网页的配色进行设置，更改标志logo，更改favicon。<br>具体操作就不说了，简单到爆。如果没有额外需求，我觉得用Bartik加上简单的颜色配置、logo配置就足够了。<br>除了颜色和logo之外，主题系统还提供了更多的配置，可以做一些常用的定制。<br>主题系统可以对以下功能进行开关：</p>
<ul>
<li>站点图标</li>
<li>站点名称</li>
<li>站点口号</li>
<li>文章中显示用户头像</li>
<li>评论中作者头像</li>
<li>评论中的用户验证状态信息</li>
<li>快捷图标</li>
<li>主菜单</li>
<li>次级菜单</li>
</ul>
<p>当然，如果不进行自定义的话，细节是没法修改（一般也不用修改），布局没法修改。这些都是定制好的，直接使用就可以了，简单方便。<br>如果需求简单，那么文章看到这里就行了。如果需要更深层次的定制，继续往下看。</p>
<p>##主题存储路径<br>在Drupal的安装目录下，有一个themes文件夹。<br>路径：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/themes</div></pre></td></tr></table></figure></p>
<p>文件夹下面一般有几个默认主题：<br><img src="http://i11.tietuku.com/8747745176a0b1e5.png" alt="Theme 3"><br>我的这个文件夹有四个主题，分别是Bartik、garland、seven、stark。<br>README.txt对这个文件夹的内容做了说明，<br>engines不是主题，它里面是PHPTemplate主题引擎。<br>如果向Drupal中添加新的主题，不应该放在默认文件夹里，而应该放在<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/sites/all/themes</div></pre></td></tr></table></figure></p>
<p>目录下。<br>这不仅可以和核心主题做区分，还可以对所有的站点可用。如果采用Drupal来支持很多站点的话，这是必需的。<br>上面展示了两个路径。但如果你使用的是定制的Drupal的话，还有可能在别的路径下面。比如你使用了<strong>Commerce Kickstart</strong>，那么下面这一条路径放置着Kickstart默认的主题：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/profile/commerce_kickstart/themes</div></pre></td></tr></table></figure></p>
<p>##目录结构<br>下面是Drupal7的例子。可能和Drupal6有一些不一样，时代更新了还是以Drupal7为准吧，等Drupal8出来再说别的。<br>打开一个主题看下面有什么，以Barktik为例：<br><img src="http://i11.tietuku.com/0804d12462cc96c1.png" alt="Theme 4"></p>
<ul>
<li>.info——该主题的信息文件，包含着主题的必要信息。比如主题名称、主题的版本、主题对应的核心版本等等。</li>
<li>color——包含主题配置管理器中的Color模块功能所需要的文件</li>
<li>css——包含了主题特有的CSS文件</li>
<li>images——包含了Bartik主题使用的图像</li>
<li>logo.png——Bartik主题的logo</li>
<li>screenshot.png——主题预览</li>
<li>template.php——模板php</li>
<li>templates——包含了Bartik主题的模版文件</li>
</ul>
<p>下面介绍模板文件。<br>基于PHPTemplate的主题都包含一个或者多个模版文件。他们的扩展名是tpl.php。<br>模版文件为页面提供了布局框架。Drupal系统中有一些默认的模板。当主题不含有相应的模版文件的时候，将会采用默认模板。所以当一些内容不需要定制的时候，很多模版文件并不是必需的。与之类似的还有CSS文件，系统中也有很多默认的CSS。当用户自定义CSS的时候，这个CSS文件的优先级要高于内核的CSS。<br>在主题模板文件中，最核心的还是page.tpl.php。它是主题中最关键的文件之一。<br>同时，在CSS文件夹中，最核心的是style.css。<br>在Bartik中，有一个文件叫做teplate.php。这个文件看似是一个最重要的模板，因为它出现在了Bartik文件夹下，而且一看名字就很重要。但是实际上，打开这个文件并没有看到预想中很多的div，而是一些代码。这个文件主要就是包含很多的高级代码片段，是一些主题化函数的重写。这个文件并不是所有主题必需的。</p>
<p>#添加主题<br>这个部分也是一个相对来说非常简单的部分。<br>点击<a href="https://www.drupal.org/project/project_theme" target="_blank" rel="noopener">https://www.drupal.org/project/project_theme</a>就可以看到一大堆主题。<br>复制某个主题的下载链接，然后打开Drupal的管理页面，外观-》安装新主题-》从URL安装，就可以直接获得了。<br>或者，从网上下载到本地，然后解压到前面所说的这个文件夹内。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/sites/all/themes</div></pre></td></tr></table></figure></p>
<p>然后再打开Drupal的管理员设置，设置一下外观，就发现该主题了。首先启用（Enable），然后设为默认（set default）就大功告成了。<br>不仅在Drupal官网上，还有很多网站也提供Drupal的主题。收费的主题一般都更加精美，而且小众化，也可以进行考虑。<br>常见的网站有：</p>
<ul>
<li>Acquia.com</li>
<li>Dream Template</li>
<li>FusionDrupalThemes.com</li>
<li>Theme Garden</li>
</ul>
<p>#定制主题<br>仅仅根据主题提供的选项进行配置，毕竟可以做的还是有限的。如截图所见，Bartik这种已经算是有较多配置选项的主题了，还可以定制颜色。很多主题的配置少得可怜，很多功能不能通过配置来实现。<br>这个时候就需要对已有的主题进行定制，或者创建我们自己的主题。<br>创建自己的主题还是算了，因为很多很多东西都要从头开始写。自己不过是想加一个功能而已，为啥要做那么多的事情，不划算。所以，子主题是最好的选择。<br>为什么不在原有的主题上直接进行修改呢。这就是模块化，怕弄乱了。前面也说了，之所以弄了两个文件夹，本身就是为了区分核心主题和自定义主题。<br>下面有一长串步骤，看起来很吓人其实也不难。现在我们要对Bartik主题进行一个定制，按照这个步骤进行操作就可以了。</p>
<ol>
<li>访问/theme目录，把bartik文件夹整个儿复制到/sites/all/themes目录下，更名为bartik2。</li>
<li>把bartik.info文件同样改名，改为bartik2.info。</li>
<li>打开bartik2.info进行编辑.</li>
<li>把name从Bartik改为Bartik2，如果有需要可以更改Description描述。</li>
<li>删除package、version两行。删除所有的stylesheets描述。</li>
<li>添加新行：base theme = bartik。</li>
<li>如果有自定义css的需要，可以在css文件夹中创建bartik2.css文件，并在bartik2.info中添加新行：stylesheets[all][]=css/bartik2.css。</li>
<li>保存并关闭bartik2.info文件</li>
<li>删除/bartik2文件夹中，不需要更改的文件。我第一次没有删除造成网站白屏，不知道为什么。后来吧template.php删除了就好了。可能是这个原因吧。反正这个template.php你应该是不需要修改的吧，一定要删除。</li>
<li>搜索替换，把/bartik2文件夹中，除了bartik2.info意外，其他所有出现bartik字样的文件，把其中的bartik一律替换为bartik2。</li>
<li>此时，打开网站，进入外观，就会发现Bartik2已经出现在了禁用主题的列表里，把它启用并设为默认，就可以了。</li>
<li>这个时候会发现内容和Bartik完全一样。不过，修改Bartik2中的文件，就可以对主题进行定制了。</li>
</ol>
<p>为什么要删除template.php，后来经过查相关资料，知道template.php是定义相关的规则。比如它可以控制加载哪些css，略过哪些css等等。如果保留这个文件，可能造成错乱，因此在第10步中，应该删除。如果对于相关东西没有研究，还是不要修改为好。</p>
<p>##定制CSS<br>CSS样式表是最常用的网页样式配置文件。最简单的方法就是直接在主题内部对CSS进行修改。</p>
<p><img src="http://i11.tietuku.com/b1927b0e05ad9fdf.png" alt="Drupal Bartik原始标题"><br>上面这张照片是我们最常见的Bartik默认主题下的标题和网站口号。假如我们觉得这个标题字体太小了，想放大一点怎么办呢？首先在网页点击右键，然后检查元素（Safari的开发模式，Firefox，Chrome等众多浏览器都有这个模式的）。这是就跳转到了HTML源代码窗口。我们找到相关代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"name-and-slogan"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"site-name"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/drupal/"</span> <span class="attr">title</span>=<span class="string">"首页"</span> <span class="attr">rel</span>=<span class="string">"home"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">span</span>&gt;</span>UI_Tech<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"site-slogan"</span>&gt;</span> 为梦想而生 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="comment">&lt;!-- /#name-and-slogan --&gt;</span></div></pre></td></tr></table></figure></p>
<p>通过这一段代码我们可以发现，网站标题的id是”site-name”。我们要定位到”site-name”，来对网站标题进行修改。我们在css/style.css中，搜索”site-name”，发现附近的代码如下：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#site-name</span> &#123;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">1.821em</span>;</div><div class="line">  <span class="attribute">color</span>: <span class="number">#686868</span>;</div><div class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">h1</span><span class="selector-id">#site-name</span> &#123;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-id">#site-name</span> <span class="selector-tag">a</span> &#123;</div><div class="line">  <span class="attribute">font-weight</span>: normal;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们把这一段代码复制到新建的bartik2.css中，然后把font-size修改为2.821.em。回到浏览器，强制刷新本页，就会发现，标题字体明显变大了。两个图的缩放比例是一致的，logo图片都是一样大的，只不过标题字体变大了。</p>
<p><img src="http://i13.tietuku.com/b0c1dd90f180cd62.png" alt="Drupal Bartik放大后的标题"><br>是不是很简单呢？通过这种方法，页面上有任何觉得不符合心目中要求的，都可以通过这种方法。<br>只要你对CSS有一定的熟悉度，知道margin、fonts、size、color等设置选项，就可以对网页进行尽情地修改。<br>而且，这些修改完全不会破坏原有主题的完整性，不需要对系统主题做任何修改。因为本目录下的bartik2.css的优先级是要高于bartik主题中的style.css的。<br>当然，尽管优先级高，也不要忘记样式表重叠。当某个样式被应用的时候，系统会汇总样式表，合并选择属性。如果核心提供了某个选择器的属性，且主题没有设置与之矛盾的选择器，那么即使其他属性被重写，系统也会定义一个包含全部属性的选择器。</p>
<p>##定制PHP模板<br>上面说了，在靠后的步骤中，要删除不需要修改的部分。其实不删除也行，反正都是一样的，只不过因为重叠地太多，再区分优先级什么的，可能会变慢。<br>刚才，我保留了bartik2/templates文件夹，保留了文件夹下的page.tpl.php文件。其实不保留也没关系，再从bartik那里复制过来就可以了。<br>这个page.tpl.php文件，在上面也说了，是核心的模版文件。<br>在这个文件的上方有一段很长很长的注释，基本介绍了这个文件是做什么的。阅读一下这个注释对于看懂下面的内容非常有帮助。下面是开头的节选<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * <span class="doctag">@file</span></span></div><div class="line"><span class="comment"> * bartik2's theme implementation to display a single Drupal page.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * The doctype, html, head and body tags are not in this template. Instead they</span></div><div class="line"><span class="comment"> * can be found in the html.tpl.php template normally located in the</span></div><div class="line"><span class="comment"> * modules/system directory.</span></div><div class="line"><span class="comment"> */</span></div></pre></td></tr></table></figure></p>
<p>翻译过来就是：<br>bartik2（之所以有2，是在前面的步骤中，把所有的Bartik都替换成了Bartik2）是一个用来展示单个页面的主题模板。Doctype、html、head、body这几个标签不在本模板中。作为替代，这些模板在html.tpl.php这个文件中。通常这个文件位于modules/system文件夹。<br>这个文件接下来定义了可以使用的全局变量，如$base_path、$directory、$is_front等等。<br>然后定义了Regions区域。<br>接下来就进入到了html标签，这里举例前几行：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"page-wrapper"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"page"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"header"</span> <span class="attr">class</span>=<span class="string">"&lt;?php print $secondary_menu ? 'with-secondary-menu': 'without-secondary-menu'; ?&gt;"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"section clearfix"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($logo): <span class="meta">?&gt;</span></span></div><div class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $front_page; ?&gt;"</span> <span class="attr">title</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> <span class="attr">rel</span>=<span class="string">"home"</span> <span class="attr">id</span>=<span class="string">"logo"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&lt;?php print $logo; ?&gt;"</span> <span class="attr">alt</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></div><div class="line"></div><div class="line">    <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($site_name || $site_slogan): <span class="meta">?&gt;</span></span></div><div class="line">      &lt;div id="name-and-slogan"&lt;?php if ($hide_site_name &amp;&amp; $hide_site_slogan) &#123; print ' class="element-invisible"'; &#125; ?&gt;&gt;</div><div class="line"></div><div class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($site_name): <span class="meta">?&gt;</span></span></div><div class="line">          <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($title): <span class="meta">?&gt;</span></span></div><div class="line">            &lt;div id="site-name"&lt;?php if ($hide_site_name) &#123; print ' class="element-invisible"'; &#125; ?&gt;&gt;</div><div class="line">              <span class="tag">&lt;<span class="name">strong</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $front_page; ?&gt;"</span> <span class="attr">title</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> <span class="attr">rel</span>=<span class="string">"home"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $site_name; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">              <span class="tag">&lt;/<span class="name">strong</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">          <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">else</span>: <span class="comment">/* Use h1 when the content title is empty */</span> <span class="meta">?&gt;</span></span></div><div class="line">            &lt;h1 id="site-name"&lt;?php if ($hide_site_name) &#123; print ' class="element-invisible"'; &#125; ?&gt;&gt;</div><div class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $front_page; ?&gt;"</span> <span class="attr">title</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> <span class="attr">rel</span>=<span class="string">"home"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $site_name; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">          <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></div><div class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></div><div class="line"></div><div class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($site_slogan): <span class="meta">?&gt;</span></span></div><div class="line">          &lt;div id="site-slogan"&lt;?php if ($hide_site_slogan) &#123; print ' class="element-invisible"'; &#125; ?&gt;&gt;</div><div class="line">            <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">print</span> $site_slogan; <span class="meta">?&gt;</span></span></div><div class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></div><div class="line"></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span> <span class="comment">&lt;!-- /#name-and-slogan --&gt;</span></div></pre></td></tr></table></figure></p>
<p>这是从开头，一直到name和slogan结束。<br>这里我们进行一些简单的尝试。找到logo的图片相关代码，如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($logo): <span class="meta">?&gt;</span></span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?php print $front_page; ?&gt;"</span> <span class="attr">title</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> <span class="attr">rel</span>=<span class="string">"myhome"</span> <span class="attr">id</span>=<span class="string">"logo"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&lt;?php print $logo; ?&gt;"</span> <span class="attr">alt</span>=<span class="string">"&lt;?php print t('Home'); ?&gt;"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">endif</span>; <span class="meta">?&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>注意到，我已经把rel的值由“home”修改为了“myhome”。<br>这个时候，需要“清除主题注册表”，才能看到效果，这是必要步骤。<br>什么是“清除主题注册表”呢，就是清缓存啦。<br>有三种方法</p>
<ol>
<li>如果长期进行类似开发，可以安装Devel模块；</li>
<li>如果超牛，对Drupal内核有很强理解，可以使用函数drupal_rebuild_theme_registry</li>
<li>如果就想试试效果，点击配置-》开发-》性能-》清除所有缓存，就可以了。</li>
</ol>
<p>完成这些步骤之后，再打开网页，检查元素或者查看源代码，就可以发现源代码变成了这样：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/drupal/"</span> <span class="attr">title</span>=<span class="string">"首页"</span> <span class="attr">rel</span>=<span class="string">"myhome"</span> <span class="attr">id</span>=<span class="string">"logo"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://localhost/drupal/sites/all/themes/bartik2/logo.png"</span> <span class="attr">alt</span>=<span class="string">"首页"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>虽然从外观上看起来没有什么变化，但是我确实从源代码上修改了模板文件。既然源代码都可以改，想要修改显示效果，还有什么不可以的呢？</p>
</div></article></div></main><footer><div class="paginator"><a href="/2014/07/14/Prog-Mind/" class="prev">PREV</a><a href="/2014/06/19/Graduate/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'maziang';
var disqus_identifier = '2014/06/22/Drupal-Theme/';
var disqus_title = 'Drupal Theme 主题系统';
var disqus_url = 'http://zablog.me/2014/06/22/Drupal-Theme/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//maziang.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2021 <a href="http://zablog.me">Zachary Marv</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-71255155-1",'auto');ga('send','pageview');</script></body></html>